# Widget Local Emulator Guide

This guide explains how to use the local Firebase emulator for testing enhanced widget configurations.

## Overview

The enhanced widget configuration system supports both production and local emulator environments. This allows you to test widget configurations locally before deploying them to production.

## Prerequisites

1. Firebase CLI installed
2. Firebase emulators configured

## Starting the Firebase Emulator

Before creating local widget configurations, start the Firebase emulator:

```bash
firebase emulators:start
```

This will start the Firestore emulator (typically on port 8080) and the Firebase emulator UI (typically on port 4000).

## Creating Enhanced Widget Configurations

### Production Configuration

To create an enhanced widget configuration in the production environment:

```bash
./run-enhanced-widget-config.sh
```

### Local Emulator Configuration

To create an enhanced widget configuration in the local emulator:

```bash
./run-enhanced-widget-config-local.sh
```

This script will:
1. Connect to the local Firestore emulator
2. Create a new widget configuration document
3. Return the widget ID for testing

## Testing the Widget

After creating a widget configuration (either in production or the local emulator), you can test it using:

```bash
./run-enhanced-widget-test.sh
```

When prompted, enter the widget ID that was generated by the configuration script.

## Viewing Configurations in the Emulator UI

You can view and manage your local widget configurations in the Firebase Emulator UI:

1. Open a browser and navigate to http://localhost:4000
2. Click on "Firestore" in the navigation menu
3. Look for the "widgets" collection
4. Find your widget configuration by ID

## Troubleshooting

### Connection Issues

If the script fails to connect to the emulator, check:

1. Is the Firebase emulator running?
2. Is the emulator running on the default port (8080)?
3. Is the `FIRESTORE_EMULATOR_HOST` environment variable set correctly in the script?

### Widget Not Appearing

If the widget doesn't appear when testing:

1. Verify the widget ID was entered correctly
2. Check the browser console for errors
3. Ensure the widget loader script is correctly loading the configuration

## Differences Between Production and Local Emulator

The main differences between production and local emulator configurations are:

1. Data persistence: Local emulator data is lost when the emulator is stopped
2. Authentication: Local emulator has simplified authentication
3. Performance: Local emulator may have different performance characteristics

For most testing purposes, the local emulator provides a suitable environment for widget development and testing.
